<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.backend.itryp">

	<!-- 공지사항 글 작성 / 카테고리 조회(배송, 결제, 회원 등) -->
	<insert id="announceInsert">
		INSERT INTO TB_BOARD(
		board_no,
		user_id,
		board_category,
		board_title,
		board_content,
		board_date
		)
		VALUES (
		TB_BOARD_NO_SEQ.NEXTVAL,
		#{user_id},
		#{board_category},
		#{board_title},
		#{board_content},
		TO_CHAR(sysdate, 'YYYY-MM-DD HH:MM:SS')
		)
	</insert>

	<!-- 1대1 문의 글 조회 -->
	<select id="inquiryList" parameterType="map" resultType="map">
		SELECT b.board_no
		, u.user_id
		, u.user_nickname
		, b.board_category
		, b.board_title
		, b.board_content
		, b.board_date
		, b.board_hit
		, b.board_like
		, b.type_board
		FROM TB_BOARD b, TB_USER u
		WHERE b.user_id = u.user_id
		AND b.board_status = 0
		<if test='board_category!=null and !board_category.equals("전체")'>
			AND b.board_category = #{board_category}
		</if>
		<if test='search != null and search.equals("작성자")'>
			AND u.user_nickname LIKE '%'||#{keyword}||'%'
		</if>
		<if test='search != null and search.equals("제목")'>
			AND b.board_title LIKE '%'||#{keyword}||'%'
		</if>
		<if test='search != null and search.equals("내용")'>
			AND b.board_content LIKE '%'||#{keyword}||'%'
		</if>
		ORDER BY b.board_no ASC
	</select>

	<!-- 1대1 문의 글 작성 -->
	<insert id="inquiryInsert" parameterType="map">
		INSERT INTO TB_QNA(
		qna_no,
		qna_step,
		user_id,
		qna_title,
		qna_content,
		qna_sort,
		qna_date
		)
		VALUES(
		TB_BOARD_NO_SEQ.NEXTVAL,
		0,
		#{user_id},
		#{qna_title},
		#{qna_content},
		2,
		TO_CHAR(sysdate, 'YYYY-MM-DD HH:MM:SS')
		)
	</insert>

	<!-- 판매자 탈퇴 글 작성 -->
	<insert id="sellerDelInsert">
		INSERT INTO TB_QNA(
		qna_no,
		qna_step,
		user_id,
		qna_title,
		qna_content,
		qna_sort,
		qna_date
		)
		VALUES(
		TB_BOARD_NO_SEQ.NEXTVAL,
		0,
		#{user_id},
		#{qna_title},
		#{qna_content},
		3,
		TO_CHAR(sysdate, 'YYYY-MM-DD HH:MM:SS')
		)
	</insert>

</mapper>