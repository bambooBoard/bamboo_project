<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.backend.itryp">
	<!-- 회원가입 -->
	<insert id="memberInsert" parameterType="map">
		INSERT INTO TB_USER(
		user_id
		,user_pw
		,user_email
		,user_nickname
		,user_name
		,user_phone
		,user_zipcode
		,user_address
		,user_address_detail
		)
		VALUES(
		<if test='USER_ID!= null'>
			,#{USER_ID}
		</if>
		<if test='USER_PW!= null'>
			,#{USER_PW}
		</if>
		<if test='USER_EMAIL!= null'>
			,#{USER_EMAIL}
		</if>
		<if test='USER_NICKNAME!= null'>
			,#{USER_NICKNAME}
		</if>
		<if test='USER_NAME!= null'>
			,#{USER_NAME}
		</if>
		<if test='USER_PHONE!= null'>
			,#{USER_PHONE}
		</if>
		<if test='USER_ZIPCODE!= null'>
			,#{USER_ZIPCODE}
		</if>
		<if test='USER_ADDRESS!= null'>
			,#{USER_ADDRESS}
		</if>
		<if test='USER_ADDRESS_DETAIL!= null'>
			,#{USER_ADDRESS_DETAIL}
		</if>
		)
	</insert>

	<!-- 로그인 -->
	<select id="login" parameterType="map" resultType="string">
		select user_nickname from TB_USER
		WHERE status = 0 AND user_id = #{user_id} AND user_pw = #{user_pw}
	</select>

	<!-- 마이페이지 들어가기->비번입력-> 상세정보 출력 -->
	<select id="memberList" parameterType="map" resultType="map">
		select user_id, user_email, user_nickname, user_name
		,user_phone, user_zipcode, user_address, user_address_detail from
		TB_USER
		WHERE user_id = #{user_id} AND user_pw = #{user_pw}
	</select>
	
	<!-- 회원정보 수정 : 수정가능한 정보 : 닉네임, 비밀번호, 핸드폰번호(재인증), 주소 -->
	<update id="memberUpdate" parameterType="map">
		update TB_USER 
			SET
			<trim prefix="SET" prefixOverrides=",">
			<if test  ='user_nickname!=null and user_nickname.length>0'>
			user_nickname = #{user_nickname}
			</if> 
			<if test = 'user_pw !=null and user_pw.length()>0'>
			,user_pw = #{user_pw}
			</if>
			<if test = 'user_phone!=null and user_phone.length()>0'>
			,user_phone = #{user_phone}
			</if>
			<if test = 'user_zipcode!=null and user_zipcode.length()>0'>
			,user_zipcode = #{user_zipcode}
			</if>
			<if test = 'user_address!=null and user_address.length()>0'>
			,user_address = #{user_address}
			</if>
			<if test = 'user_address_detail!=null and user_address_detail.length()>0'>
			,user_address_detail = #{user_address_detail}
			</if>
			</trim>
	</update>
 </mapper>